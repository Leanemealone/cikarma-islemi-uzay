<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Uzayda Matematik</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; color: white; font-family: Arial; touch-action: none; }
        canvas { display: block; background: url('https://raw.githubusercontent.com/Leanemealone/assets-images/refs/heads/main/arka%20plan%20(2).png'); background-size: cover; }
    </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// SES DOSYALARI
const arkaPlanMuzigi = new Audio('https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3');
arkaPlanMuzigi.loop = true;
arkaPlanMuzigi.volume = 0.2;

const crashSesi = new Audio('crash.mp3'); // Dosya adının aynı olduğundan emin ol

function ekranBoyutlandir() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
ekranBoyutlandir();
window.addEventListener("resize", ekranBoyutlandir);

let skor = 0; 
let meteorHizi = 1.5; 
let soru = { s1: 0, s2: 0, sonuc: 0 }; 
let meteorlar = [];
let gemi = { x: canvas.width / 2, y: canvas.height - 200 };

// Geri bildirim yazısı değişkenleri
let mesaj = "";
let mesajRengi = "";
let mesajSayac = 0; // Yazının ne kadar süre kalacağını belirler

function ekraniSalla() {
    if (navigator.vibrate) navigator.vibrate(300);
    crashSesi.play(); // Çarpma sesi
    let siddet = 15; let sayac = 0;
    document.body.style.backgroundColor = "#550000";
    let sarsintiInterval = setInterval(() => {
        let xSalla = (Math.random()*siddet*2)-siddet; let ySalla = (Math.random()*siddet*2)-siddet;
        canvas.style.transform = `translate(${xSalla}px, ${ySalla}px)`;
        if (++sayac > 15) { clearInterval(sarsintiInterval); canvas.style.transform = `translate(0,0)`; document.body.style.backgroundColor = "#000"; }
    }, 30);
}

const gemiResmi = new Image(); gemiResmi.src = 'https://raw.githubusercontent.com/Leanemealone/assets-images/refs/heads/main/uzay%20araci.png';
const meteorResmi = new Image(); meteorResmi.src = 'https://raw.githubusercontent.com/Leanemealone/assets-images/refs/heads/main/goktasi.png';

function soruUret() {
    soru.s1 = Math.floor(Math.random() * 30) + 20;
    soru.s2 = Math.floor(Math.random() * 15) + 1;
    soru.sonuc = soru.s1 - soru.s2;
    
    let yeniMeteorlar = [
        { deger: soru.sonuc, tip: "dogru" },
        { deger: soru.sonuc + 5, tip: "yanlis" },
        { deger: soru.sonuc - 3, tip: "yanlis" },
        { deger: soru.sonuc + 8, tip: "yanlis" }
    ];

    for (let i = yeniMeteorlar.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [yeniMeteorlar[i], yeniMeteorlar[j]] = [yeniMeteorlar[j], yeniMeteorlar[i]];
    }

    meteorlar = yeniMeteorlar.map((m, index) => {
        return { ...m, x: Math.random() * (canvas.width - 160), y: -200 - (index * 450) };
    });
}

// KONTROLLER
window.addEventListener("mousemove", (e) => { 
    arkaPlanMuzigi.play();
    gemi.x = e.clientX-75; gemi.y = e.clientY-75; 
});
window.addEventListener("touchstart", (e) => { 
    arkaPlanMuzigi.play();
    gemi.x = e.touches[0].clientX-75; gemi.y = e.touches[0].clientY-75; e.preventDefault(); 
}, { passive: false });
window.addEventListener("touchmove", (e) => { 
    gemi.x = e.touches[0].clientX-75; gemi.y = e.touches[0].clientY-75; e.preventDefault(); 
}, { passive: false });

function guncelle() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // MATEMATİKSEL HİZALANMIŞ SORU
    ctx.fillStyle = "yellow"; ctx.font = "bold 55px Arial"; ctx.textAlign = "right";
    let hizalamaX = canvas.width / 2 + 40;
    ctx.fillText(soru.s1, hizalamaX, 70);
    ctx.fillText(soru.s2, hizalamaX, 125);
    ctx.textAlign = "left";
    ctx.fillText("-", hizalamaX - 100, 125);
    ctx.beginPath(); ctx.strokeStyle = "yellow"; ctx.lineWidth = 5;
    ctx.moveTo(hizalamaX-110, 140); ctx.lineTo(hizalamaX+10, 140); ctx.stroke();

    ctx.fillStyle = "white"; ctx.font = "25px Arial"; ctx.textAlign = "left";
    ctx.fillText(`Puan: ${skor}`, 30, 50);

    // Geri bildirim mesajını çiz
    if (mesajSayac > 0) {
        ctx.fillStyle = mesajRengi;
        ctx.font = "bold 60px Arial";
        ctx.textAlign = "center";
        ctx.fillText(mesaj, canvas.width / 2, canvas.height / 2);
        mesajSayac--;
    }

    if (gemi.y < 200) gemi.y = 200;
    if (gemi.y > canvas.height-150) gemi.y = canvas.height-150;
    if (gemi.x < 0) gemi.x = 0;
    if (gemi.x > canvas.width-150) gemi.x = canvas.width-150;

    ctx.drawImage(gemiResmi, gemi.x, gemi.y, 150, 150);

    meteorlar.forEach((m) => {
        m.y += meteorHizi;
        ctx.drawImage(meteorResmi, m.x, m.y, 160, 160);
        ctx.fillStyle = "white"; ctx.font = "bold 35px Arial"; ctx.textAlign = "center";
        ctx.fillText(m.deger, m.x + 80, m.y + 95);

        if (gemi.x < m.x + 120 && gemi.x + 120 > m.x && gemi.y < m.y + 120 && gemi.y + 120 > m.y) {
            if (m.tip === "dogru") {
                skor += 10;
                meteorHizi += 0.1;
                mesaj = "Aferin! +10 Puan";
                mesajRengi = "#00FF00"; // Yeşil
                mesajSayac = 60; // Yaklaşık 1 saniye
                soruUret();
            } else {
                ekraniSalla();
                mesaj = "Üzgünüm, Yanlış Yaptın!";
                mesajRengi = "#FF0000"; // Kırmızı
                mesajSayac = 60;
                gemi.x = canvas.width/2-75;
                gemi.y = canvas.height-200;
                skor = 0;
                meteorHizi = 1.5;
                soruUret();
            }
        }
        if (m.y > canvas.height) { m.y = -200; m.x = Math.random()*(canvas.width-160); }
    });
    requestAnimationFrame(guncelle);
}
soruUret(); guncelle();
</script>
</body>
</html>
